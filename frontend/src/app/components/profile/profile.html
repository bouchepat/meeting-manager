<div class="container py-4">
  <div class="row">
    <div class="col-lg-8">
      <!-- Profile Card -->
      <div class="card mb-4">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-person me-2"></i>
            Profile Information
          </h5>
        </div>
        <div class="card-body">
          @if (user$ | async; as user) {
            <div class="d-flex align-items-center mb-4">
              <img
                [src]="user.photoURL || 'assets/default-avatar.png'"
                [alt]="user.displayName || 'User'"
                class="profile-avatar me-4"
                referrerpolicy="no-referrer"
                (error)="$event.target.src = 'assets/default-avatar.png'">
              <div>
                <h4 class="mb-1">{{ user.displayName || 'User' }}</h4>
                <p class="text-muted mb-0">{{ user.email }}</p>
              </div>
            </div>

            <hr class="my-4">

            <form (ngSubmit)="saveProfile()">
              <div class="mb-3">
                <label for="displayName" class="form-label">Display Name</label>
                <input
                  type="text"
                  class="form-control"
                  id="displayName"
                  [(ngModel)]="displayName"
                  name="displayName"
                  placeholder="Enter your display name">
              </div>

              <div class="mb-3">
                <label for="email" class="form-label">Email Address</label>
                <input
                  type="email"
                  class="form-control"
                  id="email"
                  [value]="user.email"
                  disabled
                  readonly>
                <small class="text-muted">Email is managed by your Google account</small>
              </div>

              <div class="d-flex gap-2">
                <button type="submit" class="btn btn-primary" disabled>
                  <i class="bi bi-check-lg me-1"></i>
                  Save Changes
                </button>
              </div>
            </form>
          } @else {
            <div class="text-center py-5">
              <i class="bi bi-person-slash display-1 text-muted"></i>
              <h4 class="mt-3">Not Signed In</h4>
              <p class="text-muted">Please sign in to view your profile</p>
            </div>
          }
        </div>
      </div>

      <!-- Account Info Card -->
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-shield-check me-2"></i>
            Account Information
          </h5>
        </div>
        <div class="card-body">
          @if (user$ | async; as user) {
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label text-muted small">Account ID</label>
                <p class="mb-0 font-monospace small">{{ user.uid }}</p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label text-muted small">Sign-in Provider</label>
                <p class="mb-0">
                  <i class="bi bi-google me-1"></i>
                  Google
                </p>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label text-muted small">Email Verified</label>
                <p class="mb-0">
                  @if (user.emailVerified) {
                    <span class="text-success">
                      <i class="bi bi-check-circle-fill me-1"></i>
                      Verified
                    </span>
                  } @else {
                    <span class="text-warning">
                      <i class="bi bi-exclamation-circle-fill me-1"></i>
                      Not Verified
                    </span>
                  }
                </p>
              </div>
            </div>
          }
        </div>
      </div>
    </div>

    <!-- Sidebar Stats -->
    <div class="col-lg-4">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-bar-chart me-2"></i>
            Activity
          </h5>
        </div>
        <div class="card-body">
          @if (loadingStats()) {
            <div class="text-center py-3">
              <span class="spinner-border spinner-border-sm text-primary"></span>
              <span class="ms-2 text-muted">Loading...</span>
            </div>
          } @else if (stats(); as s) {
            <div class="d-flex justify-content-between align-items-center mb-3">
              <span class="text-muted">Total Recordings</span>
              <span class="badge bg-primary">{{ s.totalRecordings }}</span>
            </div>
            <div class="d-flex justify-content-between align-items-center mb-3">
              <span class="text-muted">Total Duration</span>
              <span class="badge bg-info">{{ formatDuration(s.totalDurationSeconds) }}</span>
            </div>
            <div class="d-flex justify-content-between align-items-center">
              <span class="text-muted">Member Since</span>
              <span class="badge bg-secondary">{{ formatDate(s.memberSince) }}</span>
            </div>
          } @else {
            <div class="d-flex justify-content-between align-items-center mb-3">
              <span class="text-muted">Total Recordings</span>
              <span class="badge bg-primary">0</span>
            </div>
            <div class="d-flex justify-content-between align-items-center mb-3">
              <span class="text-muted">Total Duration</span>
              <span class="badge bg-info">0m</span>
            </div>
            <div class="d-flex justify-content-between align-items-center">
              <span class="text-muted">Member Since</span>
              <span class="badge bg-secondary">--</span>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
</div>
